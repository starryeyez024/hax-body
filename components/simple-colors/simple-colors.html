<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="simple-colors-behaviors.html">

<!--
`simple-colors`
Utily to control

@demo demo/index.html

@microcopy - the mental model for this element

-->

<dom-module id="simple-colors">
  <script>
    (function() {
      'use strict';
  
      Polymer.SimpleColorsUtility = Polymer({

        is: 'simple-colors',
        
        properties: {
          /**
           * Stores hex codes for accessible colors.
           */
          hexCodes: {
            type: Object,
            value: {
              "grey": ['#000000','#111111','#222222','#444444','#666666','#999999','#bbbbbb','#dddddd','#eeeeee','#ffffff'],
              "accent": ['#000000','#111111','#222222','#dddddd','#eeeeee','#ffffff'],
              "red": ['#a00000','#c70000','#ee0000','#ff2222','#ff4444','#ff6666'],
              "pink": ['#9a006e','#bb0080','#da0099','#ff2077','#ff4089','#ff5b9a'],
              "purple": ['#44006f','#6300a0','#7200ba','#dd22ee','#e75cff','#ea75ff'],
              "deepPurple": ['#1d005c','#2b0082','#32009d','#7f5fff','#9175FF','#9e86ff'],
              "indigo": ['#000f72','#00149a','#001dc4','#2277ff','#428BFF','#5da1ff'],
              "blue": ['#002b63','#0041a2','#0156c6','#0091ff','#199fff','#30aaff'],
              "lightBlue": ['#002f50','#00547e','#0075a7','#00c0ff','#22cbff','#3cd2ff'],
              "cyan": ['#00393c','#005b61','#017f8a','#22f0f0','#4fffff','#6affff'],
              "teal": ['#003930','#006559','#018e7b','#00ffa6','#1bffaf','#5dffc1'],
              "green": ['#022709','#105e26','#128737','#00f956','#38FF61','#7bff86'],
              "lightGreen": ['#122d09','#2f5c16','#438316','#6fff00','#89FF2E','#A0FF52'],
              "lime": ['#594700','#716000','#877000','#aeff00','#b4ff18','#beff4d'],
              "yellow": ['#634200','#855400','#965c00','#f6f600','#fcfc38','#ffff60'],
              "amber": ['#673800','#8F4F00','#a85c00','#dfa400','#e3b030','#ffcb62'],
              "orange": ['#8c2a00','#a83500','#bf3900','#ff9625','#ff8800','#ff9625'],
              "deepOrange": ['#820400','#a70800','#c61400','#ff7b42','#ff7738','#ff7b42'],
              "brown": ['#442d26','#5D4037','#85574a','#a47060','#b67f6f','#c28a7b'],
              "blueGrey": ['#2f4149','#455a64','#56707c','#699096','#75989F','#81a3a9']
            },
          },
        },
        
        /** 
        * Append a stylesheet of variables. (Needed for slotted content.)
        */
        ready: function() {
          let root = this, css = '', addProp = function(prop,val){
            return prop+': '+val+'; \n';
          }, addTheme = function(selector,prefix,reverse,){
            css += selector+' { ';
            for (var property in root.hexCodes) {
              if (root.hexCodes.hasOwnProperty(property)) {
                let val = reverse ? root.hexCodes[property].slice().reverse() : root.hexCodes[property].slice();
                let prop = (property!== 'grey') ? '--simple-colors'+prefix+'-'+property.replace( /([a-z])([A-Z])/g, '$1-$2' ).toLowerCase(): '--simple-colors'+prefix;
                  css += addProp(prop+'-foreground1',val[0]);
                  css += addProp(prop+'-foreground2',val[1]);
                  css += addProp(prop+'-foreground3',val[2]);
                if(property!== 'grey') {
                  css += addProp(prop+'-background3',val[3]);
                  css += addProp(prop+'-background2',val[4]);
                  css += addProp(prop+'-background1',val[5]);
                } else {
                  css += addProp(prop+'-foreground4',val[3]);
                  css += addProp(prop+'-foreground5',val[4]);
                  css += addProp(prop+'-background5',val[5]);
                  css += addProp(prop+'-background4',val[6]);
                  css += addProp(prop+'-background3',val[7]);
                  css += addProp(prop+'-background2',val[8]);
                  css += addProp(prop+'-background1',val[9]);
                }
              }
            }
            css += ' } \n\n';
          }, addAccent = function(prefix,color){
            css+= addAccentProp(prefix,'-foreground1',color);
            css+= addAccentProp(prefix,'-foreground2',color);
            css+= addAccentProp(prefix,'-foreground3',color);
            css+= addAccentProp(prefix,'-background1',color);
            css+= addAccentProp(prefix,'-background2',color);
            css+= addAccentProp(prefix,'-background3',color);
          }, addAccentProp = function(prefix,suffix,color){
            if (color !== 'grey') {
              return addProp(prefix+'-accent'+suffix,'var('+prefix+color+suffix+')');
            } else {
              return addProp(prefix+'-accent'+suffix,'var('+prefix+suffix+')');
            }
          }, colors = [
            'red','pink','purple',
            'deep-purple','indigo','blue',
            'light-blue','cyan','teal',
            'green','light-green','lime',
            'yellow','amber','orange',
            'deep-orange','brown','blue-grey',''
          ], head = document.head || document.getElementsByTagName('head')[0], style = document.createElement('style');
          addTheme('html','-light-theme',false);
          addTheme('html','-dark-theme',true);
          addTheme('html, *[dark="false"]','',false);
          addTheme('*[dark]','',true);
          for (var i=0; i<colors.length; i++){
            let color = colors[i] !== '' ? '-'+colors[i] : '', selector = colors[i] !== '' ? colors[i] : 'none';
            css+= '*[accent-color="'+selector+'"] { ';
            addAccent('--simple-colors',color);
            addAccent('--simple-colors-light-theme',color);
            addAccent('--simple-colors-dark-theme',color);
            css+= ' } \n\n';
          }
          style.type = 'text/css';
          if (style.styleSheet){
            style.styleSheet.cssText = css;
          } else {
            style.appendChild(document.createTextNode(css));
          }
    
          head.appendChild(style);
        },
      });

      Polymer.SimpleColorsUtility.instance = null;

      /**
       * Checks to see if there is an instance available, and if not appends one
       */
      Polymer.SimpleColorsUtility.requestAvailability = function() {
        if (!Polymer.SimpleColorsUtility.instance) {
          Polymer.SimpleColorsUtility.instance = document.createElement('simple-colors');
        }

        document.body.appendChild(Polymer.SimpleColorsUtility.instance);
      };
    })();
  </script>
</dom-module>
